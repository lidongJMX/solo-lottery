# 项目决策记录33 - 修复添加奖项500错误问题

## 问题描述
在管理后台尝试添加奖项时出现500内部服务器错误：
```
Failed to load resource: the server responded with a status of 500 (Internal Server Error)
AdminPage.vue:798 添加奖项失败: AxiosError
```

## 问题分析
通过排查发现两个主要问题：
1. **后端服务未启动**：端口8080被进程ID 34464占用，导致后端服务无法启动
2. **前端数据类型错误**：奖项等级字段在前端表单中使用字符串类型，但后端期望整数类型

## 解决步骤

### 1. 解决端口占用问题
- 使用 `netstat -ano | findstr :8080` 查找占用端口的进程
- 发现进程ID 34464正在占用8080端口
- 使用PowerShell命令终止进程：`powershell "Stop-Process -Id 34464 -Force"`
- 重新启动后端服务：`cd backend && npm start`

### 2. 修复前端数据类型问题
在 `AdminPage.vue` 中修复奖项等级选择器的数据类型：

**修改前**：
```vue
<el-option label="1" value="1" />
<el-option label="2" value="2" />
<!-- ... 其他选项 -->
```

**修改后**：
```vue
<el-option label="1" :value="1" />
<el-option label="2" :value="2" />
<!-- ... 其他选项 -->
```

## 技术细节

### 数据类型不匹配问题
- **前端问题**：`el-select` 组件中使用 `value="1"` 会将值作为字符串处理
- **后端期望**：数据库中 `level` 字段为 `INTEGER` 类型，期望接收数字
- **解决方案**：使用 `:value="1"` 进行数据绑定，确保传递数字类型

### 端口占用处理
- Windows环境下使用 `netstat -ano | findstr :端口号` 查找占用进程
- 使用PowerShell的 `Stop-Process -Id PID -Force` 强制终止进程
- Git Bash环境下PowerShell命令可以正常执行

## 验证结果
- ✅ 后端服务成功启动并监听8080端口
- ✅ 数据库连接正常，表结构完整
- ✅ 前端奖项等级字段现在传递正确的数字类型
- ✅ API接口应该可以正常响应添加奖项请求

## 影响范围
- **前端**：`frontend/src/components/AdminPage.vue` - 奖项等级选择器
- **后端**：服务启动和端口管理

## 预期效果
- 添加奖项功能应该可以正常工作
- 前端可以成功调用 `/api/awards` 接口
- 数据类型匹配，避免后端验证错误

## 后续建议
1. 在开发过程中注意数据类型的一致性
2. 前端表单组件的数据绑定要明确指定类型
3. 建议添加更详细的错误日志来快速定位问题
4. 可以考虑使用不同的端口避免冲突

## 修复时间
2024-12-19

## 修复状态
✅ 已完成 - 端口占用问题已解决，数据类型不匹配问题已修复