# 项目决策记录18 - 中奖弹窗显示人名和部门信息

## 问题描述
用户要求在中奖弹窗中显示获奖者的姓名和部门信息，以便更好地识别中奖人员。

## 原始状态
- 中奖弹窗只显示获奖者姓名
- 系统使用 `participantAPI.getNames()` 只获取参与者姓名列表
- 缺少部门信息的展示

## 解决方案

### 1. 修改数据获取方式
- 将 `participantAPI.getNames()` 改为 `participantAPI.getAvailable()`
- 获取包含姓名、部门等完整信息的参与者数据

### 2. 更新数据结构处理
- 修改 `participants` 数组从字符串数组改为对象数组
- 更新相关的数据过滤和处理逻辑
- 在 `drawWinners` 函数中保存部门信息到获奖者数据

### 3. 优化界面显示
- 修改中奖弹窗模板，显示姓名和部门信息
- 调整样式布局，姓名使用大字体，部门使用小字体
- 添加居中对齐和合适的间距

## 具体修改

### 前端文件修改
**文件**: `frontend/src/components/LotteryPage.vue`

1. **数据获取函数修改**:
   ```javascript
   // 修改前
   const names = await participantAPI.getNames();
   participants.value = names;
   
   // 修改后
   const participantData = await participantAPI.getAvailable();
   participants.value = participantData;
   ```

2. **抽奖逻辑修改**:
   ```javascript
   // 修改获奖者数据结构，包含部门信息
   drawnWinners.push({
     name: winner.name,
     department: winner.department,
     award: `${currentAward.value.level}等奖 - ${currentAward.value.name}`
   });
   ```

3. **界面模板修改**:
   ```html
   <!-- 修改前 -->
   <div class="bg-yellow-400 text-red-800 px-8 py-4 rounded-2xl text-3xl font-bold shadow-lg">
     {{ winner.name }}
   </div>
   
   <!-- 修改后 -->
   <div class="bg-yellow-400 text-red-800 px-8 py-4 rounded-2xl shadow-lg text-center">
     <div class="text-3xl font-bold mb-2">{{ winner.name }}</div>
     <div class="text-lg text-red-600">{{ winner.department || '未知部门' }}</div>
   </div>
   ```

4. **相关逻辑调整**:
   - 更新人名滚动逻辑，适配对象数组结构
   - 修改参与者过滤条件，使用 `p.name` 而不是直接使用 `p`
   - 更新备用数据格式为对象数组

## 效果
- 中奖弹窗现在同时显示获奖者的姓名和部门信息
- 姓名以大字体突出显示
- 部门信息以较小字体显示在姓名下方
- 保持了原有的视觉效果和用户体验

## 技术细节
- 使用了现有的 `participantAPI.getAvailable()` API
- 保持了向后兼容性，添加了部门信息的默认值处理
- 优化了界面布局，使用 TailwindCSS 进行样式调整

## 测试建议
1. 验证中奖弹窗是否正确显示姓名和部门
2. 测试在没有部门信息时的默认显示
3. 确认抽奖逻辑仍然正常工作
4. 检查人名滚动效果是否正常

## 日期
2024年12月19日