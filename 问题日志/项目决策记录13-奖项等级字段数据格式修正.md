# 项目决策记录13 - 奖项等级字段数据格式修正

## 问题描述
用户反馈奖项等级(level)字段获取的应该是数据库中的原始数据，而不是格式化后的显示文本。

## 问题分析
在 `LotteryPage.vue` 中发现以下问题：
1. `fetchAwards` 方法中将数据库的原始 level 值（数字）格式化为 `${award.level}等奖`
2. 默认数据中使用了中文格式（'一等奖'、'二等奖'等）而不是数字格式
3. 这导致前端存储的不是数据库原始数据，影响数据一致性

## 解决方案

### 1. 数据获取层修正
- 修改 `fetchAwards` 方法中的数据映射，保持 `level` 字段为数据库原始值
- 将 `level: \`${award.level}等奖\`` 改为 `level: award.level`

### 2. 默认数据修正
- 修改默认奖项数据中的 level 字段
- 将中文格式（'一等奖'、'二等奖'、'三等奖'）改为数字格式（1、2、3）

### 3. 显示层格式化
- 在模板显示时进行格式化，而不是在数据层
- 修改第159行：`{{ currentAward.level }}等奖 - {{ currentAward.name }}`
- 修改第323行：`${currentAward.value.level}等奖 - ${currentAward.value.name}`

## 技术实现

### 修改文件
- `e:\AICodeWork\solo-lottery\frontend\src\components\LotteryPage.vue`

### 具体修改内容
1. **数据映射修正**：
   ```javascript
   // 修改前
   level: `${award.level}等奖`,
   
   // 修改后
   level: award.level,
   ```

2. **默认数据修正**：
   ```javascript
   // 修改前
   level: '一等奖',
   level: '二等奖', 
   level: '三等奖',
   
   // 修改后
   level: 1,
   level: 2,
   level: 3,
   ```

3. **显示格式化**：
   ```vue
   <!-- 修改前 -->
   {{ currentAward.level }} - {{ currentAward.name }}
   
   <!-- 修改后 -->
   {{ currentAward.level }}等奖 - {{ currentAward.name }}
   ```

## 预期效果
1. **数据一致性**：前端存储的 level 字段与数据库保持一致
2. **显示正确**：界面上仍然正确显示"一等奖"、"二等奖"等格式化文本
3. **数据传输**：与后端API交互时传递的是原始数据库值
4. **维护性**：数据层和显示层职责分离，便于维护

## 风险评估
- **低风险**：修改仅涉及前端数据处理逻辑
- **兼容性**：不影响后端API和数据库结构
- **测试建议**：验证奖项显示和抽奖功能正常工作

## 相关文件
- `frontend/src/components/LotteryPage.vue` - 主要修改文件
- `backend/src/database/init.js` - 数据库level字段定义（INTEGER类型）
- `backend/src/routes/awards.js` - 后端API返回原始level值

---

**修改时间**: 2024年12月
**影响范围**: 前端奖项数据处理
**测试状态**: 待测试